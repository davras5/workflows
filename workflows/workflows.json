{
  "$schema": "./workflows.schema.json",
  "workflows": [
    {
      "id": "egid-gwr-checker",
      "name": "EGID/GWR Checker",
      "type": "enricher",
      "description": "Vergleicht Adressdaten mit dem offiziellen Schweizer Gebäude- und Wohnungsregister (GWR).",
      "description_long": "Gleicht Ihre Gebäudedaten mit dem offiziellen Gebäude- und Wohnungsregister (GWR) der Schweiz ab. Anhand der EGID werden Koordinaten und Adressdaten vom GWR abgerufen und mit Ihren Daten verglichen. Abweichungen werden bewertet und als Evaluation-Score ausgegeben.",
      "category": "GWR",
      "input": {
        "formats": [".xlsx", ".xls", ".csv"],
        "formats_description": "Excel oder CSV-Datei mit Gebäudedaten",
        "max_size_mb": 50
      },
      "inputs": [
        {
          "id": "bbl_id",
          "name": "bbl_id",
          "description": "Interne BBL-ID (Buchungskreis/Wirtschaftseinheit/Teilobjekt)",
          "format": "string",
          "example": "1000/2345/001",
          "required": true
        },
        {
          "id": "av_egid",
          "name": "av_egid",
          "description": "Eidgenössischer Gebäudeidentifikator gemäss GWR",
          "format": "string",
          "format_description": "8-9 stellige Zahl",
          "example": "123456789",
          "required": true
        },
        {
          "id": "wgs84_lat",
          "name": "wgs84_lat",
          "description": "Breitengrad in WGS84-Koordinaten (Latitude)",
          "format": "string",
          "format_description": "Dezimalgrad",
          "example": "46.9480",
          "required": false
        },
        {
          "id": "wgs84_lon",
          "name": "wgs84_lon",
          "description": "Längengrad in WGS84-Koordinaten (Longitude)",
          "format": "string",
          "format_description": "Dezimalgrad",
          "example": "7.4474",
          "required": false
        },
        {
          "id": "adr_reg",
          "name": "adr_reg",
          "description": "Region (international) oder Kanton (Schweiz)",
          "format": "string",
          "format_description": "2-Buchstaben Kantonskürzel für CH",
          "allowed_values": ["ZH", "BE", "LU", "UR", "SZ", "OW", "NW", "GL", "ZG", "FR", "SO", "BS", "BL", "SH", "AR", "AI", "SG", "GR", "AG", "TG", "TI", "VD", "VS", "NE", "GE", "JU"],
          "example": "BE",
          "required": false
        },
        {
          "id": "adr_ort",
          "name": "adr_ort",
          "description": "Ortsname",
          "format": "string",
          "example": "Bern",
          "required": false
        },
        {
          "id": "adr_plz",
          "name": "adr_plz",
          "description": "Postleitzahl",
          "format": "string",
          "format_description": "4-stellige Schweizer PLZ",
          "example": "3003",
          "required": false
        },
        {
          "id": "adr_str",
          "name": "adr_str",
          "description": "Strassenname",
          "format": "string",
          "example": "Bundesplatz",
          "required": false
        },
        {
          "id": "adr_hsnr",
          "name": "adr_hsnr",
          "description": "Hausnummer",
          "format": "string",
          "example": "3",
          "required": false
        }
      ],
      "outputs": [
        {
          "id": "gwr_wgs84_lat",
          "name": "gwr_wgs84_lat",
          "description": "Breitengrad gemäss GWR (WGS84)",
          "format": "string",
          "format_description": "Dezimalgrad",
          "example": "46.9480",
          "required": false
        },
        {
          "id": "gwr_wgs84_lon",
          "name": "gwr_wgs84_lon",
          "description": "Längengrad gemäss GWR (WGS84)",
          "format": "string",
          "format_description": "Dezimalgrad",
          "example": "7.4474",
          "required": false
        },
        {
          "id": "gwr_gkode",
          "name": "gwr_gkode",
          "description": "Ost-Koordinate gemäss GWR (LV95)",
          "format": "string",
          "format_description": "LV95 E-Koordinate",
          "example": "2600000",
          "required": false
        },
        {
          "id": "gwr_gkodn",
          "name": "gwr_gkodn",
          "description": "Nord-Koordinate gemäss GWR (LV95)",
          "format": "string",
          "format_description": "LV95 N-Koordinate",
          "example": "1200000",
          "required": false
        },
        {
          "id": "gwr_adr_reg",
          "name": "gwr_adr_reg",
          "description": "Kanton gemäss GWR",
          "format": "string",
          "example": "BE",
          "required": false
        },
        {
          "id": "gwr_adr_ort",
          "name": "gwr_adr_ort",
          "description": "Ortsname gemäss GWR",
          "format": "string",
          "example": "Bern",
          "required": false
        },
        {
          "id": "gwr_adr_plz",
          "name": "gwr_adr_plz",
          "description": "Postleitzahl gemäss GWR",
          "format": "string",
          "example": "3003",
          "required": false
        },
        {
          "id": "gwr_adr_str",
          "name": "gwr_adr_str",
          "description": "Strassenname gemäss GWR",
          "format": "string",
          "example": "Bundesplatz",
          "required": false
        },
        {
          "id": "gwr_adr_hsnr",
          "name": "gwr_adr_hsnr",
          "description": "Hausnummer gemäss GWR",
          "format": "string",
          "example": "3",
          "required": false
        },
        {
          "id": "eval_score",
          "name": "eval_score",
          "description": "Übereinstimmungs-Score (0-100)",
          "format": "number",
          "format_description": "Prozent der übereinstimmenden Felder",
          "example": "85",
          "required": true
        },
        {
          "id": "eval_label",
          "name": "eval_label",
          "description": "Bewertungskategorie basierend auf Score",
          "format": "string",
          "allowed_values": ["Match", "Partial", "Mismatch", "Not Found"],
          "example": "Match",
          "required": true
        }
      ],
      "rules": [
        {
          "id": "R-GWR-01",
          "name_de": "EGID Pflichtfeld",
          "description_de": "av_egid darf nicht leer, 0 oder NULL sein",
          "severity": "error",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-02",
          "name_de": "EGID Eindeutigkeit",
          "description_de": "av_egid muss im Datensatz eindeutig sein",
          "severity": "warning",
          "default_enabled": true,
          "category": "consistency"
        },
        {
          "id": "R-GWR-03",
          "name_de": "Koordinaten fehlen",
          "description_de": "wgs84_lat/wgs84_lon fehlt (wird vom GWR ergänzt)",
          "severity": "info",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-04a",
          "name_de": "Kanton fehlt",
          "description_de": "adr_reg (Kanton) fehlt oder ist leer",
          "severity": "info",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-04b",
          "name_de": "Ort fehlt",
          "description_de": "adr_ort (Ortsname) fehlt oder ist leer",
          "severity": "info",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-04c",
          "name_de": "PLZ fehlt",
          "description_de": "adr_plz (Postleitzahl) fehlt oder ist leer",
          "severity": "info",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-04d",
          "name_de": "Strasse fehlt",
          "description_de": "adr_str (Strassenname) fehlt oder ist leer",
          "severity": "info",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-04e",
          "name_de": "Hausnummer fehlt",
          "description_de": "adr_hsnr (Hausnummer) fehlt oder ist leer",
          "severity": "info",
          "default_enabled": true,
          "category": "completeness"
        },
        {
          "id": "R-GWR-05",
          "name_de": "GWR Adressabgleich",
          "description_de": "Adresskomponenten müssen mit GWR-Daten übereinstimmen",
          "severity": "warning",
          "default_enabled": true,
          "category": "matching"
        },
        {
          "id": "R-GWR-06",
          "name_de": "GWR Koordinatenabgleich",
          "description_de": "Koordinaten weichen vom GWR ab (Toleranz: 50m)",
          "severity": "warning",
          "default_enabled": true,
          "category": "matching"
        },
        {
          "id": "R-GWR-07",
          "name_de": "EGID nicht gefunden",
          "description_de": "EGID existiert nicht im GWR",
          "severity": "error",
          "default_enabled": true,
          "category": "matching"
        }
      ],
      "rule_categories": [
        {"id": "completeness", "name_de": "Vollständigkeit"},
        {"id": "consistency", "name_de": "Konsistenz"},
        {"id": "matching", "name_de": "GWR-Abgleich"}
      ]
    },
    {
      "id": "cafm-basisplan-checker",
      "name": "CAFM Basisplan Checker",
      "type": "checker",
      "description": "Validiert DWG/DXF-Dateien gegen die BBL CAFM Basisplan Richtlinien.",
      "description_long": "Prüft CAD-Zeichnungen auf Einhaltung der BBL-Layerstruktur, Namenskonventionen, Farbcodes und Linientypen gemäss den CAFM Basisplan Anforderungen.",
      "category": "CAD",
      "input": {
        "formats": [".dwg", ".dxf"],
        "formats_description": "AutoCAD DWG oder DXF Zeichnungsdatei",
        "max_size_mb": 100
      },
      "outputs": [
        {
          "id": "layer_name",
          "name": "Layer",
          "description": "Name des CAD-Layers",
          "format": "string",
          "example": "A-RAUM",
          "required": true
        },
        {
          "id": "element_type",
          "name": "Elementtyp",
          "description": "Art des CAD-Elements",
          "format": "string",
          "allowed_values": ["LINE", "POLYLINE", "ARC", "CIRCLE", "TEXT", "MTEXT", "BLOCK", "HATCH", "DIMENSION"],
          "required": false
        },
        {
          "id": "rule_id",
          "name": "Regel-ID",
          "description": "Identifikator der verletzten Regel",
          "format": "string",
          "required": true
        },
        {
          "id": "severity",
          "name": "Schweregrad",
          "description": "Fehlerklassifizierung",
          "format": "string",
          "allowed_values": ["error", "warning", "info"],
          "required": true
        },
        {
          "id": "message",
          "name": "Meldung",
          "description": "Beschreibung des Problems",
          "format": "string",
          "required": true
        },
        {
          "id": "expected_value",
          "name": "Erwartet",
          "description": "Erwarteter Wert gemäss BBL-Richtlinie",
          "format": "string",
          "required": false
        },
        {
          "id": "actual_value",
          "name": "Gefunden",
          "description": "Tatsächlich gefundener Wert",
          "format": "string",
          "required": false
        }
      ],
      "rules": [
        {
          "id": "R-CAD-01",
          "name_de": "Layer-Struktur",
          "description_de": "Alle erforderlichen BBL-Layer müssen vorhanden sein (A-RAUM, A-WAND, etc.)",
          "severity": "error",
          "default_enabled": true,
          "category": "structure"
        },
        {
          "id": "R-CAD-02",
          "name_de": "Layer-Benennung",
          "description_de": "Layer-Namen müssen der BBL-Konvention entsprechen (Präfix A-, E-, H-, etc.)",
          "severity": "error",
          "default_enabled": true,
          "category": "naming"
        },
        {
          "id": "R-CAD-03",
          "name_de": "Farbcodes",
          "description_de": "Layer-Farben müssen den BBL-Vorgaben entsprechen (ACI-Farbindex)",
          "severity": "warning",
          "default_enabled": true,
          "category": "appearance"
        },
        {
          "id": "R-CAD-04",
          "name_de": "Linientypen",
          "description_de": "Linientypen müssen den BBL-Vorgaben entsprechen (Continuous, Dashed, etc.)",
          "severity": "warning",
          "default_enabled": true,
          "category": "appearance"
        },
        {
          "id": "R-CAD-05",
          "name_de": "Textstile",
          "description_de": "Textstile und Schriftarten müssen konform sein (Arial, ISO)",
          "severity": "info",
          "default_enabled": false,
          "category": "appearance"
        },
        {
          "id": "R-CAD-06",
          "name_de": "Koordinatensystem",
          "description_de": "Zeichnung muss im korrekten Koordinatensystem (LV95) sein",
          "severity": "error",
          "default_enabled": true,
          "category": "structure"
        },
        {
          "id": "R-CAD-07",
          "name_de": "Blockdefinitionen",
          "description_de": "Verwendete Blöcke müssen BBL-Standard entsprechen",
          "severity": "warning",
          "default_enabled": true,
          "category": "naming"
        }
      ],
      "rule_categories": [
        {"id": "structure", "name_de": "Struktur"},
        {"id": "naming", "name_de": "Benennung"},
        {"id": "appearance", "name_de": "Darstellung"}
      ]
    },
    {
      "id": "ifc-to-excel",
      "name": "Export IFC to Excel",
      "type": "converter",
      "description": "Exportiert Gebäudedaten aus IFC-Dateien in ein Excel-Format.",
      "description_long": "Extrahiert Räume, Bauteile und deren Eigenschaften aus IFC-Dateien (BIM) und erstellt eine strukturierte Excel-Tabelle für die weitere Verarbeitung in CAFM-Systemen.",
      "category": "BIM",
      "input": {
        "formats": [".ifc"],
        "formats_description": "IFC-Datei (Industry Foundation Classes, Version 2x3 oder 4)",
        "max_size_mb": 200
      },
      "parameters": [
        {
          "id": "element_types",
          "name_de": "Elementtypen",
          "description_de": "Welche IFC-Elemente sollen exportiert werden?",
          "type": "select",
          "options": [
            {"value": "all", "label": "Alle Elemente"},
            {"value": "spaces", "label": "Nur Räume (IfcSpace)"},
            {"value": "building_elements", "label": "Nur Bauteile (Wände, Türen, Fenster)"}
          ],
          "default": "all"
        },
        {
          "id": "include_properties",
          "name_de": "Eigenschaften einbeziehen",
          "description_de": "IFC PropertySets und Attribute exportieren",
          "type": "boolean",
          "default": true
        },
        {
          "id": "include_geometry",
          "name_de": "Geometrie-Daten",
          "description_de": "Bounding Box und Flächen-/Volumenangaben exportieren",
          "type": "boolean",
          "default": false
        },
        {
          "id": "hierarchy",
          "name_de": "Gebäudehierarchie",
          "description_de": "Projekt > Gebäude > Stockwerk > Raum Struktur beibehalten",
          "type": "boolean",
          "default": true
        }
      ],
      "outputs": [
        {
          "id": "global_id",
          "name": "GlobalId",
          "description": "IFC Global Unique Identifier",
          "format": "string",
          "format_description": "22-stelliger Base64-kodierter GUID",
          "example": "3cUkl32yn9qRSPv0i4TXL4",
          "required": true
        },
        {
          "id": "ifc_type",
          "name": "IFC-Typ",
          "description": "IFC-Elementklasse",
          "format": "string",
          "allowed_values": ["IfcSpace", "IfcWall", "IfcDoor", "IfcWindow", "IfcSlab", "IfcColumn", "IfcBeam", "IfcStair", "IfcRoof"],
          "example": "IfcSpace",
          "required": true
        },
        {
          "id": "name",
          "name": "Name",
          "description": "Elementbezeichnung aus IFC",
          "format": "string",
          "example": "Büro 101",
          "required": true
        },
        {
          "id": "long_name",
          "name": "Langname",
          "description": "Erweiterte Bezeichnung (falls vorhanden)",
          "format": "string",
          "required": false
        },
        {
          "id": "building",
          "name": "Gebäude",
          "description": "Zugehöriges Gebäude",
          "format": "string",
          "example": "Hauptgebäude",
          "required": false
        },
        {
          "id": "storey",
          "name": "Stockwerk",
          "description": "Zugehöriges Stockwerk",
          "format": "string",
          "example": "1. OG",
          "required": false
        },
        {
          "id": "area",
          "name": "Fläche",
          "description": "Nettofläche in m²",
          "format": "number",
          "format_description": "Dezimalzahl mit 2 Nachkommastellen",
          "example": "25.50",
          "required": false
        },
        {
          "id": "volume",
          "name": "Volumen",
          "description": "Nettovolumen in m³",
          "format": "number",
          "format_description": "Dezimalzahl mit 2 Nachkommastellen",
          "example": "76.50",
          "required": false
        },
        {
          "id": "usage_type",
          "name": "Nutzungsart",
          "description": "Raumnutzung gemäss SIA 416",
          "format": "string",
          "example": "Büro",
          "required": false
        }
      ]
    }
  ]
}
